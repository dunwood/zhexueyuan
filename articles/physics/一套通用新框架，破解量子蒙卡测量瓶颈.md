# 一套通用新框架，破解量子蒙卡测量瓶颈

> 发布日期: 2026-02-19

量子蒙特卡罗是处理大规模强关联系统最有力的无偏数值工具之一，但其“测量能力”长期受限于一个深层困境：只能高效测量在路径积分表象下的对角物理量。非对角观测量虽往往承载量子物质的核心信息，却因与采样权重“零重叠”，在传统QMC中几乎“不可见”。

本文作者近期在《自然-通讯》发文提出一套新的通用框架，通过在连续路径上连接原本难以重叠的采样分布，为量子蒙特卡罗在大尺度体系中研究非对角关联的临界行为、无序算符以及量子多体纠缠等问题提供了新路径。其核心思想亦可延伸至大数据分布比较、机器学习中的重要性采样等领域。感兴趣的读者可以进一步阅读相关论文。

**撰文|王枳妍、刘泽楠（西湖大学物理系量子多体计算实验室）**

量子蒙特卡罗（QMC）能在多项式的时间内模拟尺寸很大的二维及高维量子体系，但“能模拟”不等于“什么都能测”。许多关键物理量，比如横向自旋等时关联、非对角虚时间关联函数、甚至某些非局域的“无序算符”，都属于所谓的非对角测量。这类测量会从根本上改变采样位形的结构，导致常规“边采样边读数”的套路彻底失效。

为此，基于重赋权思想**[1, 2]**，我们提出了一种名为双组分重赋权退火(bipartite reweight-annealing，BRA)的通用框架**[3]**，其核心在于：将任意非对角观测统一写为两个配分函数之比，再通过两条独立、可控的退火路径与一个已知的参考点，重构出目标结果。这一思想，还可以进一步扩展到更多非常规物理量的测量中，比如纠缠熵、纠缠负性、量子魔法等**[4-6]**。

本文集中讨论如何解决QMC中的测量瓶颈，为系统研究非对角关联、非局域的无序算符等前沿问题打开了大门。

1

为什么非对角测量在QMC里这么难？

在凝聚态物理中，非对角物理量往往与对角物理量的行为表现不同，有可能揭示对角物理量更难直接反映的信息，或者能与对角的物理量形成互补。比如，常见的量子磁体材料中，当我们选择在z方向的基底探测物理量时，x和y方向等关联函数对应于横向自旋涨落，其动力学结构因子能体现自旋波等激发的谱权重，这是实验与数值计算里最常用的对照之一；又比如，在U(1)对称性的反铁磁系统中，z方向磁化强度在热力学极限下为0，但是非对角关联函数的不同的衰减行为可能标志着自发的连续对称性破缺（如XY非对角序）。在量子临界点附近，横向关联函数的衰减指数也能反映普适类。当然，一个典型例子是玻色-爱因斯坦凝聚中，与对角的密度-密度关联不同，单粒子密度矩阵的非对角关联函数具有著名的非对角长程序（ODLRO），是量子相干的宏观体现。因此，这些非对角算符往往与探测系统的量子相干性和纠缠有关，是凝聚态物理中的重要物理量之一。

从数值的角度上来说，我们当然希望能够测量越多的信息，才能更精确地捕捉系统的行为。然而，不仅是解析上更难以计算，测量一般的非对角关联函数在技术上也具有挑战性。

量子蒙特卡洛作为凝聚态物理里最重要也是最主流的数值工具之一，为了测量和计算非对角物理量，通常需要设计额外的估计技巧。在量子蒙卡里，对角测量就像在同一张地图上统计：你采样到的每个位形Wi，都直接贡献一个数值Oi，最后求平均即可。而非对角测量则像是换了一张地图再问同一个问题：插入算符后，原有位形的权重Wi被改写成另一套，两套分布往往几乎没有重叠。

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_1.jpg)

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_2.jpg)

图1测量示意图：左边是测量对角算符的情况，右边是测量非对角算符遇到的情况，用分布大致对比这两种测量。对角测量就相当于在原分布中采样，而非对角测量由于目标分布和现有分布几乎不重叠，对采样的效率造成严重威胁。

这意味着，用Wi的采样去估计的总和，就像用北京的天气数据去推测广州的降雨概率——采样再久，也可能偏差巨大。更棘手的是，在多数QMC算法中，我们无法设计出能在{Wi}和{}之间直接跳转的更新方式，即缺乏普遍有效的局部更新手段，导致“换地图”的过程在算法上不可实现。这种“分布不重叠”的困难，实际上与统计学中经典的“分布比较问题”同源。

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_3.jpg)

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_4.jpg)

2

历史上的巧解：很多很漂亮，但往往依赖特定结构

过去几十年，人们确实想出了不少精巧办法，让某些非对角量在特定模型或特定框架下变得可测。例如，行列式QMC（DQMC）**[7]**则利用Wick定理，将高阶关联函数拆解为低阶格林函数的乘积；对于世界线/SSE这类框架，蠕虫算法（worm algorithm）**[8-10]**通过引入“开放世界线”的更新，能够直接采样两点格林函数，自然也可以计算非对角的等时间和虚时间关联函数。但是其推广到多体非对角关联函数相对来说比较复杂。

这些方案往往利用模型结构、对称性或更新方式，把“换分布”这件事局部化或隐式化，在各自适用范围内非常高效，也深刻影响了后来的算法设计。然而，它们大多无法推广到任意算符、任意模型，更难以处理多体关联、非局域算符等观测量。

我们这次的目标更普适：把“测量”抽象成一个统一的比值问题，然后用同一套框架在普适的场景中去处理任意的算符观测量。

3

核心想法：把“不可直接比”变成“两条可退火的比值”

前面我们说，在QMC的展开构型中测量非对角，就像估计两张不同的地图一样，那么有没有什么办法绕过直接估算呢？有的。

如果两个分布离得太远，我们就不硬比，而是让它们分段接近。具体来说，分为三步：

1. 写成比值形式：任何观测⟨O⟩都可写为/Z，其中Z=tr(e-βH)是常规配分函数，而对于静态可观测量，=tr(Oe-βH)是插入算符后的“广义配分函数”。

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_5.jpg)

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_6.jpg)

2. 分别退火：对Z和分别沿某个参数（如耦合强度Δ、系统尺寸L、虚时间τ）进行小步重赋权。例如，从参数J到J'，只要J'足够接近J，就能用Z(J)的采样稳定估计比值Z(J')/Z(J)。

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_7.jpg)

3. 连接参考点：选择一个容易求解的参数点J0（如对称性高的“海森堡点”、或小尺寸精确解），分别计算(J)/(J0)和Z(J)/Z(J0)，再通过已知的拼回目标值：

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_8.jpg)

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_9.jpg)

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_10.jpg)

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_11.jpg)

这就像两条独立的登山路线：各自沿缓坡前进，最后在山脊处汇合。这里的参考点（reference point），就是让问题变得可解的桥梁。

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_12.jpg)

图2图左表示与Z在目标参数处分布不重叠（无法直接作比）；图右显示两条独立退火路径（红与蓝）分别从目标参数退火至易解参考点，每一步保持相邻分布重叠。

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_13.jpg)

4

等时非对角关联：最基本的示例

要验证这个方法是否有效，最简单、也是最基础的做法，就是找一些最基本的模型用来做基准测试。我们首先选择有向圈算法**[11-13]**的最基础模型XXZ model，通过BRA算法计算的非对角关联函数与精确对角化（exact diagonalization）的结果直接做对比。最典型的非对角量，就是横向关联，比如⟨⟩。在许多QMC表象（如σz基）中，x方向算符会翻转自旋，从而改变世界线的连接方式，对应的统计权重属于另一套系综，传统方法难以直接抽样。

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_14.jpg)

对于XXZ model（这里可以简单地设置外场为0）：

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_15.jpg)

其中∑⟨i,j⟩表示最近邻求和。前面的J>0表示模型是反铁磁的，Δ控制Ising耦合强度，当Δ=0时模型变成一维XY模型，可以映射到自由费米子模型；当Δ=1时模型回到具有SU(2)对称性的反铁磁海森堡模型。

BRA的做法干净利落：在XXZ模型中，我们自然地选取具有SU(2)对称性的海森堡点（Δ=1）作为参考点，在这个对称点上，在该点，即对角关联函数和非对角关联函数应该相同，关键在于，对角关联函数可通过常规测量得到。接着，为了让分子(Δ)和分母Z(Δ)分别沿Δ从1退火到目标值（比如我们想知道的是Δ=0.1处的非对角关联，那么我们就退火到0.1即可），每一步保证相邻Δ的权重比在O(1)范围内，从而维持退火过程的相邻配分函数保持极大的重叠。最后，将两条路径的累积比值与参考点的已知关联相乘，即得目标关联函数。

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_16.jpg)

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_17.jpg)

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_18.jpg)

具体而言，我们先强调我们手上现在有两个流型：一个是Z=tr(e-βH)标准流型，一个是=tr(Oe-βH)含插入算符的流型。两种配分函数各做Reweight-Annealing，因此分为两条路径（红&蓝），每条路径获得一系列的配分函数之比和，再乘上SU(2)参考点。

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_19.jpg)

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_20.jpg)

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_21.jpg)

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_22.jpg)

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_23.jpg)

图3基准测试结果。横轴（Δ）：控制自旋相互作用各向异性的关键参数。当Δ=1时为著名的海森堡点，具有SU(2)旋转对称性；Δ<1时体系向平面各向异性（XY）倾向。纵轴：红色方块/蓝色圆点代表通过BRA方法计算得到的归一化关联函数比值（）。该数值直观反映了目标关联函数相对于参考点Δ=1数值的缩放比例。黑色实线：通过精确对角化得到的严格基准结果。图中展示了：(a)两点关联、(b)四点关联，以及(c)二维小格点上的关联。所有QMC数据点（带误差棒）均紧密贴合ED基准线。

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_24.jpg)

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_25.jpg)

蒙卡测试表明，从两点到四点，从一维到二维，BRA给出的结果与精确对角化完美吻合，且单次模拟即可获得整条参数曲线，效率远高于传统逐点计算。聪明的你也能想到，非局域的无序算符只是多插入很多非对角算符的操作而已，即让O=…如二维横场伊辛模型中的⟨⟩，这是一个包含R2个算符的非局域观测量，也可以构造进=tr(Oe-βH) 中，对于横场伊辛模型，我们选择的参考点是直积态。

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_26.jpg)

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_27.jpg)

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_28.jpg)

等时关联只是第一步，除了等时的，当然也能算虚时间的，否则怎么能叫“通用框架”呢？

5

虚时相关：沿“时间轴”做退火，把算符插入点搬来搬去

虚时间相关函数定义为，不同虚时间τ对应的广义配分函数各自对应一套位形集合，彼此不直接相通。

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_29.jpg)

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_30.jpg)

我们再次运用BRA思想，但这次退火的“轴”是虚时间τ，不像只改变哈密顿量的参数那么简单，而是涉及所有算符数的贡献，因而可回到朴实的Metropolis比值思想。我们构造一个扩展系综，同时包含和的位形，并在该系综中进行蒙特卡罗更新。此时，比值可直接由两类位形的采样次数比估计，得到的比值反映了τ从τ'的接受率。通过逐步增大τ，移动算符和估计频次，我们就能将相关函数从一个时间点连续搬运到另一个时间点，从而获得整条虚时曲线。

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_31.jpg)

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_32.jpg)

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_33.jpg)

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_34.jpg)

图4时间轴上算符插入点滑动的示意图；横轴是虚时间方向，纵向表示系统格点延伸方向。这里可以是任意插入算符，用τ,τ'表示它在虚时间方向的不同位置。蓝色区域表示它移动会涉及到的体内其它哈密顿量算符。

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_35.jpg)

当你能在大体系里高精度得到非对角算符的虚时曲线，接下来就可借助随机解析延拓**[14]**等成熟工具，获得其激发谱。例如，在XXZ链中，我们成功提取了自旋横向分量Sxx(q,ω)的谱，发现其低能边界尖锐、连续谱较弱，与对角谱Szz(q,ω)的宽连续谱形成鲜明对比——这正是各向异性相中不同激发模式的直观反映。

6

外延与推广：时间、空间、尺寸

前面我们讲了对哈密顿量的参数Δ做退火，或者对虚时间轴τ做退火，系统地展示了该方法计算等时、虚时、多体非局域算符的强大能力。你能否脑洞大开，意识到空间的格点、距离，系统的尺寸、甚至是维度都可以都可以成为那条可退火的“轴”？那么恭喜，你已经领会到BRA的精神。正如一开始提出这个框架的研究者，这个看似简单扩展的洞察，却打开了新世界的大门。它意味着：

沿虚时间轴退火，可以滑动算符的插入点，从而获得完整的虚时关联函数G(τ)，这是提取激发谱的基石。

沿空间轴退火，可以改变算符之间的空间距离。例如，固定系统大小，通过调节中间耦合，我们可以将最近邻关联的测量值，“搬运”到远距离关联，从而高效扫描整个空间不同距离的关联函数。

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_36.jpg)

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_37.jpg)

沿系统尺寸退火，可以从一个精确对角化可解的小系统（如4个格点）出发，通过逐渐“激活”新增格点间的耦合，将测量结果连续外推到巨大系统（如48个格点），实现了从小尺寸精确解到大尺寸蒙卡模拟的无缝衔接。

对QMC来说，测量的边界一旦被推开，许多“以前只能在小系统上看”的问题，就能在大系统上系统研究。BRA的价值不只在于某个具体结果，而在于提供了一套可复用的流程模板：写成比值、选退火坐标（参数、空间、时间）、确保相邻重叠、用参考点拼接。

它本质上解决了统计学中“不同分布函数重叠估计”的经典难题，其思想可延伸至大数据分布比较、机器学习中的重要性采样等领域。在量子多体物理中，当“难测”变成“可退火”，新的研究领域——非对角临界标度、无序算符的测量、量子多体纠缠的刻画——也随之打开。我们期待更多研究者接过这一工具，探索那些曾因“测不到”而被遮蔽的量子风景。

**参考文献**

[1] Dai, Z. & Xu, X. Y. Residual entropy from the temperature incremental Monte Carlo method.Phys. Rev. B111, L081108 (2025)

[2] Ding, Y.-M., Sun, J.-S., Ma, N., Pan, G., Cheng, C. & Yan, Z. Reweight-annealing method for evaluating the partition function via quantum Monte Carlo calculations.Phys. Rev. B110, 165152 (2024)

[3] Wang, Z., Liu, Z., Mao, B.-B., Wang, Z. & Yan, Z. Addressing general measurements in quantum Monte Carlo.Nat. Commun.17, 679 (2026).https://doi.org/10.1038/s41467-025-67324-0

[4] Ding, Y.-M., Tang, Y., Wang, Z., Wang, Z., Mao, B.-B. & Yan, Z. Tracking the variation of entanglement Rényi negativity: A quantum Monte Carlo study.Phys. Rev. B111, L241108 (2025).

[5] Wang, Z., Wang, Z., Ding, Y.-M., Mao, B.-B. & Yan, Z. Bipartite reweight-annealing algorithm of quantum Monte Carlo to extract large-scale data of entanglement entropy and its derivative.Nat. Commun.16, 5880 (2025).https://doi.org/10.1038/s41467-025-61084-7

[6] Ding, Y.-M., Wang, Z. & Yan, Z.Evaluating Many-Body Stabilizer Rényi Entropy by Sampling Reduced Pauli Strings: Singularities, Volume Law, and Nonlocal Magic.PRX Quantum6, 030328 (2025)

[7] Assaad, F. F. & Evertz, H. G. World-line and Determinantal Quantum Monte Carlo Methods for Spins, Phonons and Electrons, pages 277–356. Springer Berlin Heidelberg, Berlin, Heidelberg (2008).https://doi.org/10.1007/978-3-540-74686-7_10

[8] Prokof’ev, N. & Svistunov, B. Worm algorithm for problems of quantum and classical statistics. InUnderstanding Quantum Phase Transitions(ed. Carr, L. D.) (Taylor & Francis, 2010).

[9] Alet, F., Wessel, S. & Troyer, M. Generalized directed loop method for quantum Monte Carlo simulations.Phys. Rev. E71, 036706 (2005).

[10] Zhu, W. & Guo, W. Measuring off-diagonal correlation function in stochastic series expansion quantum Monte Carlo simulation.J. Beijing Norm. Univ. (Nat. Sci.)57, 593–600 (2021)

[11] Syljuåsen, O. F. & Sandvik, A. W.Quantum Monte Carlo with directed loops. Phys. Rev. E 66, 046701 (2002).

[12] Syljuåsen, O. F. Directed loop updates for quantum lattice models.Phys. Rev. E67, 046701 (2003).

[13] Evertz, H. G. The loop algorithm.Adv. Phys.52, 1–66 (2003).

[14] Shao, H. & Sandvik, A. W. Progress on stochastic analytic continuation of quantum Monte Carlo data.Phys. Rep.1003, 1–88 (2023)

注：本文封面图片来自版权图库，转载使用可能引发版权纠纷。

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_38.jpg)

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_39.jpg)

**微信实行乱序推送，常点“在看”，可防失联**

![图片](/articles/images/一套通用新框架，破解量子蒙卡测量瓶颈/img_40.jpg)